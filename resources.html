<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resources - Tokyo International SDA Church</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- THE CREATION GRID -->
    <div class="creation-grid">
        <div class="grid-column-1-6"></div>
        <div class="sabbath-column">
            <div class="sabbath-column__overlay u-theme--background-color--base">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 253.71 227.63">
                    <title>Seventh-day Adventist logo mark</title>
                    <path fill="white" d="M67.68,120.38c-.1-9.91,2.8-18.41,20.8-36.41l39-39c10.4-10.4,19.1-19.29,19.1-29V.67c0-.89-1.1-.89-1.2,0-2.6,12.4-7.5,17.3-17.8,27.61L82.28,73.47c-17.1,17-19.5,35.1-15.8,46.91C66.78,121.38,67.68,121.47,67.68,120.38Zm64.2,38.9c0,.89,1,.89,1.2,0,2.6-12.5,7.6-17.4,17.8-27.61L166,116.78c19.8-19.9,10.7-39-.9-44.31-1-.5-1.4.31-.6,1,9.3,8,6.5,21.5-5.2,33.2L151,115c-10.4,10.31-19.1,19.2-19.1,29Zm81.8,26.6L168,178.17l-17.1,17.11c-10.4,10.39-19,19.3-19,29V227c0,.7.9.9,1.2.11,3.2-8.7,13.9-18.11,33.5-14.8,0,0,85.4,14.8,86.1,14.8a.9.9,0,0,0,1-.61.79.79,0,0,0-.2-.8c-.3-.39-39.8-39.8-39.8-39.8Zm-107.5,1h15a.66.66,0,0,0,.6-.6c0-7.9-6-13.31-30-9.2L40,186S.58,225.37.28,225.78a.79.79,0,0,0-.1,1.1.81.81,0,0,0,.8.2c.7-.11,86.1-14.8,86.1-14.8,19.6-3.31,30.3,6,33.5,14.8.3.8,1.2.7,1.2-.11v-29.5a.66.66,0,0,0-.6-.6l-15,.1a.64.64,0,0,1-.6-.6v-8.9a.65.65,0,0,1,.6-.6Zm26.8,25.9a36.3,36.3,0,0,1,6.9-15.81h-7.5a.65.65,0,0,0-.6.61v15.2c0,.89,1.1.89,1.2,0Zm13.6-158.6c0-.91-1.1-.91-1.2,0-2.6,12.39-7.5,17.29-17.8,27.6l-39.8,39.69c-19.8,19.81-10.7,39,.9,44.31,1,.5,1.4-.4.6-1-9.3-8-6.5-21.61,5.2-33.2l33-33c10.4-10.4,19.1-19.3,19.1-29Zm-19.1,17.49c10.4-10.3,19-19.2,19.1-29V27.27c0-.9-1.1-.9-1.2,0-2.6,12.4-7.5,17.4-17.8,27.7L86.68,95.78c-19.8,19.8-23.3,39-13.2,51.4.7.8,1.4.3,1-.7-6.7-15.1,9.3-31.1,16.9-38.7Zm37.6,82.5-14.3,14.2c-6.5,6.5-12.3,12.4-15.8,18.4h14.1l1.7-1.7,20.5-20.5c17.1-16.9,19.5-35,15.8-46.8-.3-1-1.2-1.1-1.2,0,.1,9.9-2.8,18.4-20.8,36.4Zm-2.8-24-11.4,11.5c-10.4,10.4-19.1,19.4-19.1,29.11v15.3c0,.89,1.1.89,1.2,0,2.6-12.4,7.5-17.4,17.8-27.7L167,142.17c19.8-19.8,23.3-39,13.2-51.4-.7-.8-1.4-.3-1,.7C185.88,106.57,169.88,122.57,162.28,130.17Zm83.5,68.2h1.1l1.7,3h1.5l-2-3.3a2,2,0,0,0,1.3-2c0-1.5-.8-2.2-2.7-2.2h-2.2v7.5h1.3v-3Zm0-3.5h.8c1,0,1.4.3,1.4,1.2,0,.7-.5,1.2-1.4,1.2h-.9v-2.4Zm1,9a6.3,6.3,0,1,0-6.3-6.3,6.08,6.08,0,0,0,5.87,6.3Zm0-11.7a5.4,5.4,0,1,1,0,10.8,5.31,5.31,0,0,1-5.4-5.23h0v-.16a5.24,5.24,0,0,1,5.11-5.39h.29Z"></path>
                </svg>
            </div>
        </div>
    </div>
    
    <div class="content-container">
        <header>
            <h1>Tokyo International Seventh-day Adventist Church</h1>
            <img src="images/logo/header/adventist-en-centered--white.svg" alt="Tokyo International Seventh-day Adventist Church" class="church-logo">
        </header>

        <button class="dropdown-menu-btn" onclick="toggleDropdown()">Menu</button>
        
        <nav class="dropdown-nav" id="dropdown-nav">
            <a href="index.html">Home</a>
            <a href="about.html">About Us</a>
            <a href="ministries.html">Ministries</a>
            <a href="sermon.html">Sermons</a>
            <a href="events.html">Events</a>
            <a href="resources.html">Resources</a>
            <a href="visit.html">Visit Us</a>
        </nav>

        <main>
            <section id="resources-content">
                <h2>Church Resources & Bulletins</h2>
                <p>Access our latest church resources, weekly bulletins, and event materials. Files are automatically updated from our shared Google Drive folder.</p>
                
                <div class="drive-container">
                    <div class="drive-loading">
                        <p>üìÇ Loading resources from Google Drive...</p>
                    </div>
                    
                    <div id="drive-files" class="drive-items" style="display: none;">
                        <!-- Files will be populated here -->
                    </div>
                </div>

                <div class="drive-help">
                    <p><strong>Access our Google Drive:</strong> <a href="https://drive.google.com/drive/folders/1cdIImsxn_sQeLUbBfgAnFWMhJL4HVsL" target="_blank">View All Files</a></p>
                    <p><strong>Need help?</strong> Contact us at <a href="mailto:info@tokyoadventist.org">info@tokyoadventist.org</a></p>
                </div>
            </section>
        </main>

        <footer>
            <p>¬© 2023 Tokyo International Seventh-day Adventist Church</p>
        </footer>
    </div>

    <script>
        // Dropdown menu functionality
        function toggleDropdown() {
            const dropdownNav = document.getElementById('dropdown-nav');
            dropdownNav.classList.toggle('active');
            
            // Prevent body scrolling when dropdown is open
            if (dropdownNav.classList.contains('active')) {
                document.body.classList.add('no-scroll', 'menu-open');
            } else {
                document.body.classList.remove('no-scroll', 'menu-open');
            }
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdownNav = document.getElementById('dropdown-nav');
            const dropdownBtn = document.querySelector('.dropdown-menu-btn');
            
            if (!dropdownNav.contains(event.target) && !dropdownBtn.contains(event.target)) {
                dropdownNav.classList.remove('active');
                document.body.classList.remove('no-scroll', 'menu-open');
            }
        });
        
        // Close dropdown when clicking on a link
        document.getElementById('dropdown-nav').addEventListener('click', function(e) {
            if (e.target.tagName === 'A') {
                document.getElementById('dropdown-nav').classList.remove('active');
                document.body.classList.remove('no-scroll', 'menu-open');
            }
        });

        // Google Drive Integration
        const DRIVE_FOLDER_ID = '1cdIImsxn_sQeLUbBfgAnFWMhJL4HVsL';
        
        async function loadDriveFiles() {
            try {
                // Google Drive folder public sharing URL
                const folderUrl = `https://drive.google.com/drive/folders/${DRIVE_FOLDER_ID}`;
                
                // Since we can't directly access Google Drive API without authentication,
                // we'll create a simple system that encourages users to check the shared folder
                const driveContainer = document.getElementById('drive-files');
                const loadingDiv = document.querySelector('.drive-loading');
                
                // Simulate loading with a slight delay for better UX
                setTimeout(() => {
                    loadingDiv.style.display = 'none';
                    driveContainer.style.display = 'block';
                    
                    // Create a clean, user-friendly display
                    driveContainer.innerHTML = `
                        <div class="drive-section">
                            <h3>üìÑ Latest Church Resources</h3>
                            <p>All our files are automatically synced to our shared Google Drive folder.</p>
                            <a href="${folderUrl}" target="_blank" class="drive-link drive-folder-link">
                                üìÅ Open Google Drive Folder
                            </a>
                        </div>
                        
                        <div class="drive-section">
                            <h3>üìã How to Access Files</h3>
                            <ol class="drive-instructions">
                                <li>Click the "Open Google Drive Folder" link above</li>
                                <li>Browse through our organized folders</li>
                                <li>Download or view any file directly</li>
                                <li>Check back regularly for new uploads</li>
                            </ol>
                        </div>
                        
                        <div class="drive-section">
                            <h3>üìÖ File Categories</h3>
                            <div class="drive-categories">
                                <span class="drive-category">Weekly Bulletins</span>
                                <span class="drive-category">Event Flyers</span>
                                <span class="drive-category">Registration Forms</span>
                                <span class="drive-category">Church Newsletters</span>
                                <span class="drive-category">Special Announcements</span>
                            </div>
                        </div>
                    `;
                }, 1000);
                
            } catch (error) {
                console.error('Error loading drive files:', error);
                const loadingDiv = document.querySelector('.drive-loading');
                loadingDiv.innerHTML = `
                    <p>‚ùå Unable to load Google Drive files.</p>
                    <p><a href="https://drive.google.com/drive/folders/${DRIVE_FOLDER_ID}" target="_blank">Click here to access our Google Drive folder directly</a></p>
                `;
            }
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadDriveFiles();
        });
    </script>
</body>
</html>